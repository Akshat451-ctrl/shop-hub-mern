# üçÉ MongoDB Atlas Setup Guide

## Step-by-Step MongoDB Atlas Configuration

### Step 1: Create MongoDB Atlas Account

1. Go to https://www.mongodb.com/cloud/atlas/register
2. Sign up with email or Google
3. Verify your email
4. Complete the welcome survey (optional)

### Step 2: Create a Free Cluster

1. Click **"Build a Database"**
2. Choose **"M0 FREE"** tier
3. Select:
   - **Cloud Provider:** AWS (recommended)
   - **Region:** Choose closest to you
4. **Cluster Name:** Keep default or name it `Cluster0`
5. Click **"Create"**
6. Wait 3-5 minutes for cluster creation

### Step 3: Create Database User

1. You'll see a security quickstart
2. **Authentication Method:** Username and Password
3. Enter:
   - **Username:** `shopuser` (or your choice)
   - **Password:** Click "Autogenerate Secure Password" or create your own
   - **IMPORTANT:** Copy and save this password!
4. Click **"Create User"**

### Step 4: Whitelist IP Address

1. Scroll down to **"Where would you like to connect from?"**
2. Click **"Add My Current IP Address"**
3. **IMPORTANT:** Also add **"0.0.0.0/0"** to allow Render to connect:
   - Click **"Add a Different IP Address"**
   - Enter: `0.0.0.0/0`
   - Description: `Allow all (for Render)`
   - Click **"Add Entry"**
4. Click **"Finish and Close"**

### Step 5: Get Connection String

1. Click **"Connect"** button on your cluster
2. Choose **"Connect your application"**
3. **Driver:** Node.js
4. **Version:** 4.1 or later
5. Copy the connection string (looks like this):
   ```
   mongodb+srv://shopuser:<password>@cluster0.xxxxx.mongodb.net/?retryWrites=true&w=majority
   ```
6. **Replace `<password>`** with your actual password
7. **Add database name** before the `?`:
   ```
   mongodb+srv://shopuser:yourpassword@cluster0.xxxxx.mongodb.net/shophub?retryWrites=true&w=majority
   ```

### Step 6: Test Connection Locally

1. Update your local `backend/.env`:
   ```env
   MONGODB_URI=mongodb+srv://shopuser:yourpassword@cluster0.xxxxx.mongodb.net/shophub?retryWrites=true&w=majority
   ```

2. Test the connection:
   ```bash
   cd backend
   npm run seed
   ```

3. If successful, you'll see:
   ```
   ‚úÖ Connected to MongoDB
   üóëÔ∏è  Cleared existing products
   ‚úÖ Successfully seeded 20 products
   ```

### Step 7: Add to Render

1. Go to https://dashboard.render.com/
2. Click on your service
3. Go to **Environment** tab
4. Add or update:
   ```
   MONGODB_URI=mongodb+srv://shopuser:yourpassword@cluster0.xxxxx.mongodb.net/shophub?retryWrites=true&w=majority
   ```
5. Click **"Save Changes"**
6. Redeploy your service

## üîí Security Best Practices

### 1. Strong Password
- Use autogenerated password
- Or create one with letters, numbers, and symbols
- Avoid: `<`, `>`, `:`, `@`, `/` (they need URL encoding)

### 2. IP Whitelist
- Add `0.0.0.0/0` for Render
- Optionally add your home IP for local development

### 3. Database User Privileges
- Use "Read and write to any database" for development
- For production, create specific database access

## üêõ Common Issues

### Issue: "Authentication failed"

**Cause:** Wrong username or password

**Solution:**
1. Go to Database Access
2. Edit user
3. Reset password
4. Update connection string

### Issue: "IP not whitelisted"

**Cause:** Render's IP not allowed

**Solution:**
1. Go to Network Access
2. Add `0.0.0.0/0`
3. Wait 2-3 minutes for changes to apply

### Issue: "Connection string invalid"

**Cause:** Special characters in password not encoded

**Solution:**
1. Use URL encoding for special characters:
   - `@` ‚Üí `%40`
   - `:` ‚Üí `%3A`
   - `/` ‚Üí `%2F`
   - `?` ‚Üí `%3F`
2. Or use a simpler password without special characters

### Issue: "Database not found"

**Cause:** Database name not in connection string

**Solution:**
Add `/shophub` before the `?`:
```
mongodb+srv://user:pass@cluster.net/shophub?retryWrites=true&w=majority
```

## üìù Connection String Format

```
mongodb+srv://[username]:[password]@[cluster-url]/[database]?retryWrites=true&w=majority
```

**Example:**
```
mongodb+srv://shopuser:MyPass123@cluster0.abc123.mongodb.net/shophub?retryWrites=true&w=majority
```

**Parts:**
- `shopuser` - Your database username
- `MyPass123` - Your password
- `cluster0.abc123.mongodb.net` - Your cluster URL
- `shophub` - Your database name

## ‚úÖ Verification Checklist

- [ ] MongoDB Atlas account created
- [ ] Free cluster created (M0)
- [ ] Database user created
- [ ] Password saved securely
- [ ] IP whitelist configured (0.0.0.0/0)
- [ ] Connection string copied
- [ ] Password replaced in connection string
- [ ] Database name added to connection string
- [ ] Tested locally (npm run seed)
- [ ] Added to Render environment variables
- [ ] Backend redeployed on Render

## üéØ Quick Reference

### MongoDB Atlas Dashboard
https://cloud.mongodb.com/

### Important Sections:
- **Database:** View your clusters
- **Database Access:** Manage users
- **Network Access:** Manage IP whitelist
- **Connect:** Get connection strings

### Connection String Template:
```
mongodb+srv://USERNAME:PASSWORD@CLUSTER.mongodb.net/shophub?retryWrites=true&w=majority
```

## üí° Pro Tips

1. **Save credentials** - Store username and password securely
2. **Use environment variables** - Never hardcode connection strings
3. **Whitelist 0.0.0.0/0** - Required for Render to connect
4. **Test locally first** - Run seed command to verify connection
5. **Check cluster status** - Make sure cluster is active (green)

## üéâ Success!

Once configured correctly:
- ‚úÖ Local development connects to Atlas
- ‚úÖ Render backend connects to Atlas
- ‚úÖ Database is seeded with products
- ‚úÖ APIs return data
- ‚úÖ Frontend loads products

---

**Your MongoDB Atlas is now ready for production! üöÄ**
